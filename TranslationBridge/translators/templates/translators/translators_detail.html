{% extends 'main/base.html' %}
{% load static %}


{% block title %} Create translators detail information page {% endblock %}

{% block style %}
<style>
    main
    {
        width: 100%;
        height: fit-content;
        gap: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-repeat: no-repeat;
        background-size: cover;
        flex-direction: column;
        background-image: url('/static/images/detail-bg.jpg');
    }
    .detail-section
    {
        margin: 80px;
        padding: 100px;
        width: 1000px;
        height: fit-content;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: row;
        gap: 50px;
        box-shadow: rgba(14, 30, 37, 0.12) 0px 2px 4px 0px, rgba(14, 30, 37, 0.32) 0px 2px 16px 0px;
    }
    .detail-section .translator-img
    {
        width: 350px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .detail-section .translator-img img
     {
        position: absolute;
        height: fit-content;
        width: 350px;
     }
    .detail-section .translator-detail-content
    {
        width: 550px;
        height: fit-content;
        display: flex;
        align-items: left;
        justify-content: center;
        flex-direction: column;
    }
    
    

</style>
{% endblock %}

{% block content %}
<section class="detail-section">
    <div class="translator-detail-content">
        <h1>Translator Information</h1>
        <h3>Name:</h3>
        <p>{{ translator.name }}</p><!-- add translator name here -->
        <h3>Specialty:</h3>
        <p>{{ translator.specialties.name}}</p><!-- add translator specialty here -->
        <h3>Languages:</h3>
        <!-- using for loop-->
         {% for language in  translator.languages.all %} <!-- or using translator.language.id ?!-->
            <p>{{ language.name }}</p><!-- add translator languages here -->
         {% endfor %}
         
        <h3>Rating:</h3>
        <p>{{ translator.get_rating_display }}</p>

        <h3>Experience:</h3>
        <p>{{ translator.experience }}</p><!-- add translator specialty here -->
        <h3>Location:</h3>
        <!-- the user can click on the city then the location page turn on and shows the other translators in the same city -->
        <p>{{ translator.city.country.name }} : {{ translator.city.name  }}</p><!-- add translator location of the city live in here -->
        
        <!-- Don't forgit add contact information also {email address,phone number}-->
        



        {% if request.user.is_authenticated and request.user.profile.user_type == 'company' %}
            <!-- the link shows just for company users -->
            <a href="{% url 'translators:create_translator_view' %}">Add request</a>         
        {% endif %}

        {% if request.user.is_authenticated and request.user == translator.user %}
            <!-- the link shows just for translator user have the same user id -->
            <a href="{% url 'translators:translator_update_view' translator.id %}">Update information</a>

            <!-- the link shows just for translator user have the same user id -->
            <a href="{% url 'translators:translator_delete_view' translator.id %}">Delete information</a>        
        {% endif %}



    </div>   
    <div class="translator-img">
        <img src="{{translator.image.url}}" alt="">
    </div> 


    
</section>

    <!-- Reviews Section -->
    <h2 class="mt-5 mb-4">Reviews ({{ translator.review_set.count }})</h2>
    <div class="d-flex flex-column gap-3">
        {% for review in translator.review_set.all %}
            <div class="d-flex align-items-start p-3 shadow-sm rounded bg-white" style="gap: 16px;">
                <img src="{{ review.user.profile.avatar.url }}" class="rounded-circle border" style="width: 48px; height: 48px; object-fit: cover; margin-top: 4px;" />
                <div class="flex-grow-1">
                    <div class="d-flex align-items-center gap-2 mb-1">
                      
                           <h5 class="fw-semibold text-dark">{{ review.user.username }} {{ review.user.last_name }}</h5>
                        </a>
                        <span class="text-muted small ms-2">{{ review.created_at|date:"Y-m-d H:i" }}</span>
                    </div>
                    <p class="mb-0 text-secondary" style="font-size: 1.05rem;">{{ review.comment }}</p>
                </div>
            </div>
        {% empty %}
            <div class="alert alert-light text-center">No reviews yet.</div>
        {% endfor %}
    </div>
    <!-- Add Review Form -->
    {% if request.user.is_authenticated %}
        <h2 class="mt-5">Add Review</h2>
        <form class="d-flex flex-column gap-2" action="{% url 'translators:review_view' translator.id %}" method="post">
            {% csrf_token %}
            <textarea class="form-control" name="comment" required placeholder="comment..."></textarea>
            <input type="submit" class="btn btn-primary" value="Add Review"/>
        </form>
    {% else %}
            <div class="p-3 rounded bg-warning mt-4 d-flex flex-column gap-2">
                <P>Only registered users can add reviews.</P>
            </div>
    {% endif %}


{% endblock %}